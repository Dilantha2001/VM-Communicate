<!DOCTYPE html>
<html>
  <head>
    <title>VM Chat</title>
    <script>
      const SERVER_URL = "http://16.171.32.145:5000/";

      function sendMessage() {
        const message = document.getElementById("msg").value;

        fetch(SERVER_URL + "/send", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            user: "User",
            message: message,
          }),
        });

        document.getElementById("msg").value = "";
      }

      function loadMessages() {
        fetch(SERVER_URL + "/messages")
          .then((res) => res.json())
          .then((data) => {
            let chat = "";
            data.forEach((d) => {
              chat += `<p><b>${d.user}</b>: ${d.message}</p>`;
            });
            document.getElementById("chat").innerHTML = chat;
          });
      }

      setInterval(loadMessages, 1000);
    </script>
  </head>
  <body>
    <h2>AWS VM Chat</h2>

    <div
      id="chat"
      style="border: 1px solid black; height: 200px; overflow-y: scroll"
    ></div>

    <input id="msg" placeholder="Type message" />
    <button onclick="sendMessage()">Send</button>
  </body>
</html>
